"""
Tests pour le module de détection d'injection SQL
"""

import unittest
from unittest.mock import patch, Mock
from mon_projet import test_sql_injection

class TestSQLInjectionTester(unittest.TestCase):

    @patch('mon_projet.requests.get')
    def test_sql_injection_detection(self, mock_get):
        # Simuler une réponse avec une indication d'injection SQL
        mock_response = Mock()
        mock_response.status_code = 200
        mock_response.text = "SQL syntax error"
        mock_get.return_value = mock_response

        url = "http://example.com"
        result = test_sql_injection(url)
        self.assertTrue(result)

    @patch('mon_projet.requests.get')
    def test_no_vulnerability_detected(self, mock_get):
        # Simuler une réponse sans indication d'injection SQL
        mock_response = Mock()
        mock_response.status_code = 200
        mock_response.text = "All is well"
        mock_get.return_value = mock_response

        url = "http://example.com"
        result = test_sql_injection(url)
        self.assertFalse(result)

if __name__ == '__main__':
    unittest.main()
